import{e as a,s as i,u as o}from"./index-sJx7Xdqp.js";import{u as n}from"./useMutation-NgwOv-kr.js";import{i as c}from"./types-DkwUutMY.js";import{r as y}from"./ui-3vQ9-yJw.js";function d(e){const t=a();return y.useEffect(()=>{const s=i.subscribeToVisitorRequests(r=>{t.setQueryData(["/api/visitor-requests",e],r)},e);return()=>{s()}},[JSON.stringify(e),t]),o({queryKey:["/api/visitor-requests",e],queryFn:async()=>await i.getVisitorRequests(e),staleTime:1/0})}function v(){return n({mutationFn:async({data:e,residencyId:t,residencyName:s})=>{const r={...e,flatId:String(e.flatId),vehicleNumber:e.vehicleNumber||void 0},u=c.parse(r);return await i.createPublicVisitorRequest({...u,vehicleNumber:u.vehicleNumber||null},t,s)}})}function b(){const e=a();return n({mutationFn:async({id:t,status:s})=>await i.updateVisitorRequestStatus(t,s),onSuccess:()=>{e.invalidateQueries({queryKey:["/api/visitor-requests"]}),e.invalidateQueries({queryKey:["/api/admin/visitor-requests"]}),e.invalidateQueries({queryKey:["/api/admin/stats"]})}})}export{d as a,b,v as u};
