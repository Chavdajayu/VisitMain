import{r,j as e,I as E,H as L,L as D}from"./ui-3vQ9-yJw.js";import{L as H}from"./Layout-q0bwL00g.js";import{a as V}from"./use-visitor-requests-BBxtUmkU.js";import{R as P}from"./RequestCard-BvZ_Mquu.js";import{T as F,a as S,b as I,c as M}from"./tabs-CBmgB0uo.js";import{d as U,a as A}from"./index-sJx7Xdqp.js";import{M as B,u as $,P as K,a as W,b as G,L as O,m as _}from"./proxy-Dkg6DtWx.js";import"./vendor-C0Dkio3Y.js";import"./button-BxgNf8B1.js";import"./index-C-65KjJ3.js";import"./useMutation-NgwOv-kr.js";import"./types-DkwUutMY.js";import"./card-C-wb9owH.js";import"./en-US-BddybvhD.js";import"./firebase-CupIkEz0.js";class J extends r.Component{getSnapshotBeforeUpdate(a){const t=this.props.childRef.current;if(t&&a.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Q({children:n,isPresent:a}){const t=r.useId(),i=r.useRef(null),u=r.useRef({width:0,height:0,top:0,left:0}),{nonce:f}=r.useContext(B);return r.useInsertionEffect(()=>{const{width:s,height:o,top:m,left:l}=u.current;if(a||!i.current||!s||!o)return;i.current.dataset.motionPopId=t;const d=document.createElement("style");return f&&(d.nonce=f),document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${s}px !important;
            height: ${o}px !important;
            top: ${m}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[a]),e.jsx(J,{isPresent:a,childRef:i,sizeRef:u,children:r.cloneElement(n,{ref:i})})}const X=({children:n,initial:a,isPresent:t,onExitComplete:i,custom:u,presenceAffectsLayout:f,mode:s})=>{const o=$(Y),m=r.useId(),l=r.useCallback(p=>{o.set(p,!0);for(const g of o.values())if(!g)return;i&&i()},[o,i]),d=r.useMemo(()=>({id:m,initial:a,isPresent:t,custom:u,onExitComplete:l,register:p=>(o.set(p,!1),()=>o.delete(p))}),f?[Math.random(),l]:[t,l]);return r.useMemo(()=>{o.forEach((p,g)=>o.set(g,!1))},[t]),r.useEffect(()=>{!t&&!o.size&&i&&i()},[t]),s==="popLayout"&&(n=e.jsx(Q,{isPresent:t,children:n})),e.jsx(K.Provider,{value:d,children:n})};function Y(){return new Map}const v=n=>n.key||"";function q(n){const a=[];return r.Children.forEach(n,t=>{r.isValidElement(t)&&a.push(t)}),a}const Z=({children:n,custom:a,initial:t=!0,onExitComplete:i,presenceAffectsLayout:u=!0,mode:f="sync",propagate:s=!1})=>{const[o,m]=W(s),l=r.useMemo(()=>q(n),[n]),d=s&&!o?[]:l.map(v),p=r.useRef(!0),g=r.useRef(l),j=$(()=>new Map),[T,k]=r.useState(l),[x,R]=r.useState(l);G(()=>{p.current=!1,g.current=l;for(let h=0;h<x.length;h++){const c=v(x[h]);d.includes(c)?j.delete(c):j.get(c)!==!0&&j.set(c,!1)}},[x,d.length,d.join("-")]);const C=[];if(l!==T){let h=[...l];for(let c=0;c<x.length;c++){const y=x[c],N=v(y);d.includes(N)||(h.splice(c,0,y),C.push(y))}f==="wait"&&C.length&&(h=C),R(q(h)),k(l);return}const{forceRender:b}=r.useContext(O);return e.jsx(e.Fragment,{children:x.map(h=>{const c=v(h),y=s&&!o?!1:l===x||d.includes(c),N=()=>{if(j.has(c))j.set(c,!0);else return;let w=!0;j.forEach(z=>{z||(w=!1)}),w&&(b?.(),R(g.current),s&&m?.(),i&&i())};return e.jsx(X,{isPresent:y,initial:!p.current||t?void 0:!1,custom:y?void 0:a,presenceAffectsLayout:u,mode:f,onExitComplete:y?void 0:N,children:h},c)})})};function pe(){const{user:n}=U(),{data:a,isLoading:t}=V(),[i]=A();r.useEffect(()=>{n?.residencyName&&(document.title=`${n.residencyName} Resident Dashboard`)},[n?.residencyName]),r.useEffect(()=>{try{const o=new URL(i,window.location.origin).searchParams.get("requestId");if(o){const m=document.getElementById(`request-${o}`);m&&m.scrollIntoView({behavior:"smooth",block:"center"})}}catch{}},[i,t]);const u=a?.filter(s=>s.status==="pending")||[],f=a?.filter(s=>s.status!=="pending")||[];return e.jsxs(H,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-2xl font-display font-bold text-slate-900",children:["Welcome, ",n?.name||n?.username]}),e.jsx("p",{className:"text-slate-500",children:(()=>{const s=n?.flatNumber||n?.flat;return`Manage entry request for ${s?`Flat ${s}`:"Flat"} in ${n?.residencyName}.`})()})]}),e.jsxs(F,{defaultValue:"pending",className:"space-y-6",children:[e.jsxs(S,{className:"bg-white p-1 rounded-xl shadow-sm border border-slate-200",children:[e.jsxs(I,{value:"pending",className:"rounded-lg data-[state=active]:bg-primary data-[state=active]:text-white",children:[e.jsx(E,{className:"w-4 h-4 mr-2"})," Pending (",u.length,")"]}),e.jsxs(I,{value:"history",className:"rounded-lg data-[state=active]:bg-primary data-[state=active]:text-white",children:[e.jsx(L,{className:"w-4 h-4 mr-2"})," History"]})]}),t?e.jsx("div",{className:"flex justify-center p-12",children:e.jsx(D,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs("div",{className:"min-h-[400px]",children:[e.jsx(M,{value:"pending",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.jsx(Z,{children:u.length>0?u.map(s=>e.jsx(_.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},layout:!0,children:e.jsx(P,{request:s,variant:"resident"})},s.id)):e.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center p-12 text-center text-slate-400 border-2 border-dashed rounded-xl border-slate-200",children:[e.jsx(E,{className:"h-12 w-12 mb-3 opacity-20"}),e.jsx("p",{children:"No pending requests."})]})})})}),e.jsx(M,{value:"history",children:e.jsx("div",{className:"space-y-4",children:f.length>0?f.map(s=>e.jsx(P,{request:s,variant:"resident"},s.id)):e.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center text-slate-400 border-2 border-dashed rounded-xl border-slate-200",children:[e.jsx(L,{className:"h-12 w-12 mb-3 opacity-20"}),e.jsx("p",{children:"No history found."})]})})})]})]})]})}export{pe as default};
