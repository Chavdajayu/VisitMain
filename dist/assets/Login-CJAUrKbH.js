import{j as e,L as j,r as b,s as v}from"./ui-3vQ9-yJw.js";import{d as S,a as w,b as L,u as F,L as C,s as I}from"./index-sJx7Xdqp.js";import{u as E,F as R,a as l,b as c,c as d,d as m,e as x,t as $}from"./form-DmsWy2lV.js";import{B as V}from"./button-BxgNf8B1.js";import{I as g}from"./input-DhaQutbK.js";import{C as k,a as q}from"./card-C-wb9owH.js";import{S as P,a as z,b as A,c as B,d as M}from"./select-BvEVGBYH.js";import{l as T}from"./types-DkwUutMY.js";import{m as U}from"./proxy-Dkg6DtWx.js";import"./vendor-C0Dkio3Y.js";import"./firebase-CupIkEz0.js";import"./label-CG0jOVEo.js";import"./index-C-65KjJ3.js";import"./index-CL2D7O4A.js";function ae(){const{user:t,role:n,loading:o,login:f,isLoggingIn:u}=S(),[,i]=w(),{toast:y}=L();if(o)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(j,{className:"h-8 w-8 animate-spin text-primary"})});b.useEffect(()=>{if(o||!t)return;const s=t.residencyName?`/${encodeURIComponent(t.residencyName)}`:"";if(n==="admin")i(`${s}/admin`);else if(n==="guard")i(`${s}/guard`);else{const a=t.flatNumber?`/${t.flatNumber}`:"";i(`${s}/resident${a}`)}},[t,n,o,i]);const{data:h,isLoading:p}=F({queryKey:["residencies"],queryFn:async()=>await I.getResidencies()}),r=E({resolver:$(T),defaultValues:{username:"",password:"",residencyId:""}}),N=s=>{f(s,{onError:a=>{y({title:"Login Failed",description:a.message,variant:"destructive"})}})};return e.jsxs("div",{className:"min-h-screen grid lg:grid-cols-2",children:[e.jsxs("div",{className:"hidden lg:flex flex-col justify-between bg-primary p-12 text-primary-foreground relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('https://images.unsplash.com/photo-1554469384-e58fac16e23a?w=1600&h=1600&fit=crop')] opacity-10 bg-cover bg-center"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent to-primary/90"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(v,{className:"h-8 w-8"}),e.jsx("span",{className:"font-display font-bold text-2xl",children:"SecureEntry"})]}),e.jsx("p",{className:"text-primary-foreground/80",children:"Advanced Visitor Management System"})]}),e.jsx("div",{className:"relative z-10",children:e.jsx("blockquote",{className:"space-y-2",children:e.jsx("p",{className:"text-xl font-display font-medium leading-relaxed",children:'"Ensuring safety and seamless entry management for modern residential societies."'})})})]}),e.jsx("div",{className:"flex items-center justify-center p-8 bg-slate-50",children:e.jsxs(U.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"w-full max-w-sm space-y-6",children:[e.jsxs("div",{className:"text-center lg:text-left",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight text-slate-900",children:"Sign in to your account"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Select your society and login."})]}),e.jsx(k,{className:"border-0 shadow-lg",children:e.jsxs(q,{className:"pt-6",children:[e.jsx(R,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(N),className:"space-y-4",children:[e.jsx(l,{control:r.control,name:"residencyId",render:({field:s})=>e.jsxs(c,{children:[e.jsx(d,{children:"Residency"}),e.jsxs(P,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(m,{children:e.jsx(z,{children:e.jsx(A,{placeholder:p?"Loading societies...":"Select your society"})})}),e.jsxs(B,{children:[h?.map(a=>e.jsx(M,{value:a.id,children:a.name},a.id)),h?.length===0&&e.jsx("div",{className:"p-2 text-sm text-muted-foreground text-center",children:"No societies found"})]})]}),e.jsx(x,{})]})}),e.jsx(l,{control:r.control,name:"username",render:({field:s})=>e.jsxs(c,{children:[e.jsx(d,{children:"Username"}),e.jsx(m,{children:e.jsx(g,{...s})}),e.jsx(x,{})]})}),e.jsx(l,{control:r.control,name:"password",render:({field:s})=>e.jsxs(c,{children:[e.jsx(d,{children:"Password"}),e.jsx(m,{children:e.jsx(g,{type:"password",...s})}),e.jsx(x,{})]})}),e.jsx(V,{type:"submit",className:"w-full",disabled:u||p,children:u?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing in..."]}):"Sign In"})]})}),e.jsxs("div",{className:"mt-6 text-center text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"New Society? "}),e.jsx(C,{href:"/register-residency",className:"font-medium text-primary hover:underline",children:"Register your residency"})]})]})})]})})]})}export{ae as default};
